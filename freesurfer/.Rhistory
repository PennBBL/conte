output.dir<-/data/joy/BBL/studies/conte/subjectData/freesurfer/stats
output.dir<-"/data/joy/BBL/studies/conte/subjectData/freesurfer/stats"
cnr_data<- read.csv(paste(output.dir,"/cnr/cnr_buckner.csv",sep=""))
euler_data<- read.csv(paste(output.dir,"/cnr/euler_number.csv",sep=""))
#merge the files together by datexscanid
data<- cnr_data
data$left_euler<- euler_data$left_euler[match(data$scanid,euler_data$scanid)]
data$right_euler<- euler_data$right_euler[match(data$scanid,euler_data$scanid)]
View(data)
flags<- data
flags$mean_euler<-(flags$left_euler+flags$right_euler)/2
flags$mean_graycsf_cnr<- (flags$graycsflh+flags$graycsfrh)/2
flags$mean_graywhite_cnr<- (flags$graywhitelh+flags$graywhiterh)/2
View(flags)
flags<- flags[,c(1,2,10:12)]
View(flags)
graycsf_cutoff<- mean(flags$mean_graycsf_cnr-(2*sd(flags$mean_graycsf_cnr)))
graywhite_cutoff<- mean(flags$mean_graywhite_cnr-(2*sd(flags$mean_graywhite_cnr)))
euler_cutoff<- mean(flags$mean_euler-(2*sd(flags$mean_euler)))
flags$graycsf_flag<- NA
flags$graywhite_flag<- NA
flags$euler_flag<- NA
View(flags)
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<=graycsf_cutoff){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
}
} # for (i in 1:nrow(flags)){
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<=graycsf_cutoff){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
} else {
flags$euler_flag[i]<- NA
}
} # for (i in 1:nrow(flags)){
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<=graycsf_cutoff & !is.na(flags$mean_graycsf_cnr[i])){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff & !is.na(flags$mean_graywhite_cnr[i])){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff & !is.na(flags$mean_euler[i])){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
}
} # for (i in 1:nrow(flags)){
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<=graycsf_cutoff & ! is.na(flags$mean_graycsf_cnr[i])){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff & ! is.na(flags$mean_graywhite_cnr[i])){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff & ! is.na(flags$mean_euler[i])){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
}
} # for (i in 1:nrow(flags)){
flags<- flags[! is.na(flags$mean_euler),]
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<=graycsf_cutoff){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff)){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
}
} # for (i in 1:nrow(flags)){
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<=graycsf_cutoff){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
}
} # for (i in 1:nrow(flags)){
View(flags)
for (i in 1:nrow(flags)){
print(i)
}
graycsf_cutoff
graycsf_cutoff<- mean(flags$mean_graycsf_cnr-(2*sd(flags$mean_graycsf_cnr)))
graywhite_cutoff<- mean(flags$mean_graywhite_cnr-(2*sd(flags$mean_graywhite_cnr)))
euler_cutoff<- mean(flags$mean_euler-(2*sd(flags$mean_euler)))
output.dir<-"/data/joy/BBL/studies/conte/subjectData/freesurfer/stats"
cnr_data<- read.csv(paste(output.dir,"/cnr/cnr_buckner.csv",sep=""))
euler_data<- read.csv(paste(output.dir,"/cnr/euler_number.csv",sep=""))
data<- cnr_data
data$left_euler<- euler_data$left_euler[match(data$scanid,euler_data$scanid)]
data$right_euler<- euler_data$right_euler[match(data$scanid,euler_data$scanid)]
flags<- data
flags$mean_euler<-(flags$left_euler+flags$right_euler)/2
flags$mean_graycsf_cnr<- (flags$graycsflh+flags$graycsfrh)/2
flags$mean_graywhite_cnr<- (flags$graywhitelh+flags$graywhiterh)/2
flags<- flags[,c(1,2,10:12)]
graycsf_cutoff<- mean(flags$mean_graycsf_cnr-(2*sd(flags$mean_graycsf_cnr)))
graycsf_cutoff<- mean(flags$mean_graycsf_cnr-(2*sd(flags$mean_graycsf_cnr)),na.rm=T)
graycsf_cutoff<- mean(flags$mean_graycsf_cnr-(2*sd(flags$mean_graycsf_cnr,na.rm=T)),na.rm=T)
graywhite_cutoff<- mean(flags$mean_graywhite_cnr-(2*sd(flags$mean_graywhite_cnr,na.rm=T)),na.rm=T)
euler_cutoff<- mean(flags$mean_euler-(2*sd(flags$mean_euler,na.rm=T)),na.rm=T)
flags$graycsf_flag<- NA
flags$graywhite_flag<- NA
flags$euler_flag<- NA
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<= graycsf_cutoff){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
}
} # for (i in 1:nrow(flags)){
View(flags)
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<= graycsf_cutoff){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
} else {
flags$graycsf_flag[i]<- NA
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
} else {
flags$graywhite_flag[i]<- NA
}
if (flags$mean_euler[i]<=euler_cutoff){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
} else {
flags$euler_flag[i]<- NA
}
} # for (i in 1:nrow(flags)){
flags<- flags[! is.na(flags$mean_euler),]
for (i in 1:nrow(flags)){
if (flags$mean_graycsf_cnr[i]<= graycsf_cutoff){
flags$graycsf_flag[i]<- 1
} else if (flags$mean_graycsf_cnr[i]>graycsf_cutoff){
flags$graycsf_flag[i]<- 0
}
if (flags$mean_graywhite_cnr[i]<=graywhite_cutoff){
flags$graywhite_flag[i]<- 1
} else if (flags$mean_graywhite_cnr[i]>graywhite_cutoff){
flags$graywhite_flag[i]<- 0
}
if (flags$mean_euler[i]<=euler_cutoff){
flags$euler_flag[i]<- 1
} else if (flags$mean_euler[i]>euler_cutoff){
flags$euler_flag[i]<- 0
}
} # for (i in 1:nrow(flags)){
flags$noutliers.thickness.rois_outlier<- auto_qa$noutliers.thickness.rois_outlier[match(flags$scanid,auto_qa$scanid)]
View(flags)
flags<- flags[,c(1,2,6:9)]
flags[,c(1,2,6:9)]
flags<- flags[,c(1,2,6:8)]
View(flags)
flags$total_outliers<- NA
x<- cbind(flags$graycsf_flag,flags$graywhite_flag,flags$euler_flag)
flags$total_outliers<- apply(x,1,sum)
flags$flagged<- flags$total_outliers
flags$flagged[flags$flagged>0]<- 1
nsubj<- nrow(flags)
#write out flagged data
write.csv(flags,paste("/data/joy/BBL/studies/conte/subjectData/freesurfer/stats/cnr_euler_flags_n",nsubj,".csv",sep=""))
